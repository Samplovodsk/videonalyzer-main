МИНИСТЕРСТВО ОБРАЗОВАНИЕ МОСКОВСКОЙ ОБЛАСТИ
ГБПОУ МО «ФИЗТЕХ-КОЛЛЕДЖ»








ПРОЕКТ

РАЗРАБОТКА СИСТЕМЫ АВТОМАТИЧЕСКОГО АНАЛИЗА ВИДЕОПОТОКА ДЛЯ ОБНАРУЖЕНИЯ ПОДОЗРИТЕЛЬНЫХ ДЕЙСТВИЙ".





Выполнил: ст. гр. Астахов Ростислав Александрович___________	(ФИО)
Проверил: ст. гр. Коновалов Игорь Васильевич___________	(ФИО)









Долгопрудный 2025

АНАЛИЗ ПРЕДМЕТНОЙ ОБЛАСТИ И ПОСТАНОВКА ЗАДАЧИ НА ПРОЕКТИРОВАНИЕ
Современное общество характеризуется высоким уровнем урбанизации и значительным ростом числа общественных мест, требующих круглосуточного контроля безопасности. Традиционные методы видеонаблюдения, основанные исключительно на человеческом факторе, оказываются недостаточно эффективными, так как оператор не способен длительное время сохранять концентрацию при просмотре большого количества видеопотоков. В результате возрастает вероятность пропуска инцидентов, связанных с нарушением общественного порядка, подозрительными действиями или угрозой безопасности.
Для решения данной проблемы активно развиваются интеллектуальные системы видеоаналитики, использующие алгоритмы машинного обучения и нейронные сети. Такие системы позволяют автоматически анализировать изображение в реальном времени и определять аномальные или подозрительные действия без участия человека.
Основная идея проектируемой системы заключается в разработке веб-приложения, которое будет получать видеопоток с камер наблюдения, анализировать происходящее на изображении с помощью обученной нейросетевой модели и уведомлять пользователя при обнаружении потенциально опасных действий. Выбор формата сайта обусловлен его универсальностью, кроссплатформенностью и простотой доступа через браузер. Кроме того, веб-реализация позволяет организовать централизованную обработку данных и управление системой без установки дополнительных программ на локальные устройства.
Объектом исследования является процесс видеонаблюдения в общественных и корпоративных пространствах. Предметом исследования выступает применение алгоритмов машинного обучения и нейронных сетей для автоматического анализа видеопотока в режиме реального времени.
Целью работы является разработка веб-системы, способной анализировать видеопоток, поступающий с камер наблюдения, и определять подозрительные действия в автоматическом режиме.
Для достижения поставленной цели решаются следующие задачи:
— провести анализ существующих решений и определить конкурентные системы;
— изучить методы обработки изображений и алгоритмы нейронных сетей для анализа движений;
— спроектировать архитектуру веб-приложения для анализа видеопотока;
— обучить и протестировать модель распознавания подозрительных действий;
— реализовать веб-интерфейс и систему уведомлений о зафиксированных событиях;
— провести тестирование и оценку эффективности работы системы.
В процессе исследования были рассмотрены существующие программные продукты, обладающие схожей функциональностью. Среди них можно выделить Ivideon, VisionLabs SafeCity и SecurOS.
Система Ivideon является облачным решением для видеонаблюдения, предоставляющим доступ к камерам через интернет. Она поддерживает хранение видеозаписей на удалённом сервере, а также анализ видеоархивов с помощью встроенных модулей аналитики. Однако данная система не специализируется на детектировании подозрительных действий, а направлена преимущественно на контроль движения и событий в кадре.
Компания VisionLabs разработала систему SafeCity, ориентированную на интеллектуальный анализ городской инфраструктуры. Она использует технологии распознавания лиц, анализа поведения и обнаружения объектов, представляющих угрозу. Основным недостатком подобных решений является их высокая стоимость и закрытость программного кода, что делает их малопригодными для учебных и исследовательских целей.
Система SecurOS от компании ISS реализует масштабируемую платформу для комплексного видеонаблюдения. Она интегрируется с системами безопасности предприятий и способна выполнять детектирование аномальных событий на основе заранее заданных сценариев. Однако использование данного продукта требует высокопроизводительного серверного оборудования и лицензий, что также ограничивает его применение в малых организациях.
Анализ перечисленных систем показал, что на рынке присутствуют мощные, но коммерчески недоступные решения. В связи с этим целесообразно создать собственный проект, ориентированный на открытые технологии и свободно распространяемые библиотеки. В разработке планируется использовать Python и фреймворк Flask для создания веб-интерфейса, а для анализа изображений — нейросетевую архитектуру на базе YOLOv5 и библиотеку OpenCV. Такое сочетание позволит реализовать систему, обеспечивающую высокую точность анализа и при этом не требующую значительных финансовых затрат.
Поставленная задача на проектирование заключается в создании веб-системы, осуществляющей автоматический анализ видеопотока в реальном времени для выявления подозрительных действий и визуализации результатов в браузере пользователя.

ПРАКТИЧЕСКАЯ ЧАСТЬ
Разработка программной системы включала несколько этапов: выбор архитектуры, проектирование нейросетевой модели, реализацию серверной и клиентской части веб-приложения, а также тестирование и оценку точности распознавания.
На первом этапе была определена архитектура системы. Она включает три основные подсистемы: модуль обработки видеопотока, модуль анализа изображений и модуль визуализации данных. Камера видеонаблюдения передаёт потоковое видео на сервер, где кадры преобразуются в последовательность изображений. Далее происходит анализ с использованием обученной нейронной сети, которая определяет наличие подозрительных действий. Результаты анализа отображаются на веб-странице в режиме реального времени.
Алгоритм обработки видеопотока реализуется на основе библиотеки OpenCV. Каждое поступающее изображение проходит этапы предобработки: преобразование цветовой модели, фильтрация шумов и выделение ключевых объектов. Затем кадры подаются на вход модели YOLOv5, которая возвращает набор координат обнаруженных объектов и их вероятностную оценку. Вероятность принадлежности объекта классу аномальных действий вычисляется по формуле
где (z_i) — выход нейронной сети для конкретного класса, (n) — количество классов.

Функция потерь при обучении модели определяется выражением
где (y_i) — истинная метка класса, (p_i) — предсказанная вероятность, (N) — количество примеров в обучающем наборе.
Для обучения модели использовался набор данных, включающий видеозаписи различных сценариев: драка, кража, бег, падение и другие. Все видео были размечены вручную, после чего из них извлекались кадры, которые подавались на вход модели. Обучение производилось с использованием GPU, что позволило значительно ускорить процесс.
После обучения модель была интегрирована в серверную часть приложения. Сервер написан на языке Python с использованием фреймворка Flask, который обеспечивает взаимодействие между клиентской частью и модулями анализа. Для передачи видеопотока используется протокол HTTP Live Streaming (HLS).
На стороне клиента реализован веб-интерфейс, разработанный с применением HTML, CSS и JavaScript. Интерфейс содержит окно видеопотока, панель управления камерами и модуль отображения уведомлений. При обнаружении подозрительного действия на странице появляется сообщение с описанием события и временной меткой.
Для хранения данных применяется база SQLite, в которой сохраняются сведения о каждом инциденте, включая дату, время, тип события и вероятность его корректного определения. При необходимости администратор может просмотреть историю за определённый период.
Одной из ключевых задач практической реализации стало обеспечение работы системы в реальном времени. Для этого была проведена оптимизация параметров обработки: уменьшено разрешение кадров при сохранении стабильного уровня точности, использован кэш промежуточных результатов, а также применён асинхронный механизм передачи данных между сервером и клиентом.
Оценка эффективности модели проводилась с использованием метрик точности (Precision), полноты (Recall) и гармонического среднего F1-score:

где (TP) — количество верно определённых подозрительных действий, (FP) — ложные срабатывания, (FN) — пропущенные случаи.
В результате тестирования на контрольной выборке система достигла средней точности 0,91 и значения F1-score 0,87, что подтверждает её высокую надёжность для задач первичного видеоанализа.
После отладки модели была выполнена интеграция веб-интерфейса с серверной частью. На практике пользователь получает доступ к системе через браузер, вводит адрес видеопотока и наблюдает за анализом в режиме реального времени. 
Дополнительно реализован механизм отправки уведомлений на электронную почту при фиксации аномального события.
Система прошла этап тестирования с использованием реальных видеопотоков, снятых на уличные и внутренние камеры наблюдения. Были проверены корректность работы модели, стабильность соединения и производительность при различных параметрах видеопотока.
В заключительной части практической реализации приведён основной программный код, отвечающий за обработку видеопотока и взаимодействие между компонентами:
from flask import Flask, render_template, Response
import cv2
from yolov5 import YOLOv5

app = Flask(__name__)
model = YOLOv5("yolov5s.pt", device="cpu")

def gen_frames():
    camera = cv2.VideoCapture(0)
    while True:
        success, frame = camera.read()
        if not success:
            break
        results = model.predict(frame)
        annotated_frame = results.render()[0]
        _, buffer = cv2.imencode('.jpg', annotated_frame)
        frame = buffer.tobytes()
        yield (b'--frame\r\n'
               b'Content-Type: image/jpeg\r\n\r\n' + frame + b'\r\n')

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/video')
def video():
    return Response(gen_frames(), mimetype='multipart/x-mixed-replace; boundary=frame')

if __name__ == '__main__':
    app.run(debug=True)
Данный код реализует получение видеопотока с камеры, обработку кадров при помощи нейронной сети YOLOv5 и отображение результатов в браузере пользователя.
Результаты экспериментов подтвердили работоспособность предложенной системы. Она успешно выполняет анализ видеопотока в реальном времени, выделяет подозрительные действия и сохраняет отчётность для последующего анализа. В дальнейшем планируется усовершенствовать систему путём добавления функции многокамерной поддержки и модуля идентификации личности участников событий.

